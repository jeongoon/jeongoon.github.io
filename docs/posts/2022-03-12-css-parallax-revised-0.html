<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" class="font-sans">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

    <meta name="author" content="Myoungjin Jeon">


    <meta name="description" content="show example css parallax applied.">


    <meta name="keywords" content="css, parallax">


    <title>MJ's kind weird Code - Css Parallax Effect revised in 2022</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Atma:wght@300;500;700&family=Fredoka:wght@300;500;700&family=Gamja+Flower&family=Hubballi&family=Mali:ital,wght@0,300;0,500;0,700;1,300;1,500;1,700&family=Oswald:wght@300;500;700&family=Unica+One&display=swap" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="../css/19Mar2022.css" />
    <link rel="stylesheet" type="text/css" href="../css/code.css" />
  </head>
  <body class="surface-color">
    <header class="main-header">
      <div id="logo" class="font-atma primary-color">
        <a href="../">MJ's Kind Weird Code</a>
      </div>
      <div id="page-title">
        <p> ðŸ“° Css Parallax Effect revised in 2022<p>
      </div>
      <nav id="main-nav" class="font-menu-title">
        <a href="../">Home</a>
        <a href="../about.html">About</a>
        <a href="../contact.html">Contact</a>
        <a href="../archive.html">Archive</a>
      </nav>
    </header>

    <div id="content" class="font-friendly">
            <div class="info">
    Posted on March 12, 2022
    
        by Myoungjin Jeon
    
</div>

<h2 id="credit-information">Credit Information</h2>
<p>This article is highly based on <a href="https://keithclark.co.uk/articles/pure-css-parallax-websites/">Keith Clarkâ€™s article</a>.</p>
<p>Another article I found is from <a href="https://orangeable.com/css/parallax-scroll">orangetable.com</a>
which has simpler approach but also talked about another kind of caveat
found on Safarai and iOS.
<em>cannot link directly</em></p>
<hr />
<h1 id="css-parallax-series">Css Parallax Series</h1>
<ol type="1">
<li><em>Css Parallax Effect revised in 2022</em></li>
<li><a href="../posts/2022-03-18-css-parallax-revised-1.html">Css Parallax Effect revised with css grid</a></li>
</ol>
<hr />
<h1 id="my-first-css-parallax-example">My first css parallax example</h1>
<p>I have some article about css parallax which is work in process.
and <a href="../examples/07Mar2022.CssParallax/cssParallaxExample.html"><strong>THIS</strong></a> is the first version of working Html+Css.</p>
<h1 id="the-parallax-effects-soley-by-css">The Parallax Effects soley by CSS</h1>
<p>It has been more than eight years since he posted about parallax effect
by using css transformation. the Most of major web browser implements
differently, so we need to embrace the caveats in the end.</p>
<p>However it still has technical merit if we could gain those effects even
without javascript. and so many websites have the basic parallax on their
home page..</p>
<p>So why donâ€™t you check out?</p>
<h1 id="css-transformation">Css Transformation</h1>
<p>the basic concepts are very well explained in</p>
<p><a href="https://keithclark.co.uk/articles/pure-css-parallax-websites/#the-theory">The Theory</a>
on Keithâ€™s article.</p>
<p>concisely, to get 3d transformation we need:</p>
<p><code>three elements with some attributes</code></p>
<ol type="1">
<li>base element and a <code>perspective</code> from where we see the object on the page.
(which is generally not moving during transformation)</li>
<li>an <code>anchor element</code>(normally <code>div</code>) contains the elements which is
actually tranformed.</li>
<li><code>transformation origin</code>
(default is the center of the anchor (parent) element.</li>
</ol>
<p>In another words â€“ in css:
<em>(this is different from original article but using same magic)</em></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">.css-parallax-toplevel</span> {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">perspective</span>: <span class="dv">100</span><span class="dt">px</span><span class="op">;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">height</span>: <span class="dv">100</span><span class="dt">vh</span><span class="op">;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">overflow-x</span>: <span class="dv">hidden</span><span class="op">;</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">overflow-y</span>: <span class="bu">auto</span><span class="op">;</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">.css-parallax-group</span> {</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">/* we can have serveral pallax group but</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">     * we are going to use only one group here */</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">position</span>: <span class="dv">relative</span><span class="op">;</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">height</span>: <span class="dv">500</span><span class="dt">px</span><span class="op">;</span> <span class="co">/* fallback for older browsers */</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">height</span>: <span class="dv">100</span><span class="dt">vh</span><span class="op">;</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">/* prevents the browser flattening the `css-parallax-group` elements */</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">transform-style</span>: preserve-3d<span class="op">;</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">.css-parallax-layer</span> {</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">/* common settings for an element under `css-parallax-group` */</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">/* v fill the space of the container */</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">top</span>: <span class="dv">0</span><span class="op">;</span> <span class="kw">right</span>: <span class="dv">0</span><span class="op">;</span> <span class="kw">bottom</span>: <span class="dv">0</span><span class="op">;</span> <span class="kw">left</span>: <span class="dv">0</span><span class="op">;</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">position</span>: <span class="dv">relative</span><span class="op">;</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co">/* about css selectors:</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co"> * https://www.w3schools.com/cssref/css_selectors.asp</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="fu">.css-parallax-layer.as-background</span> {</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="co">/* v pull out from the content flow */</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">position</span>: <span class="dv">absolute</span><span class="op">;</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">transform</span>: translateZ(<span class="dv">-400</span><span class="dt">px</span>)<span class="op">;</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>   <span class="kw">-webkit-transform</span>: translateZ(<span class="dv">-400</span><span class="dt">px</span>)<span class="op">;</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="fu">.css-parallax-layer</span> <span class="op">&gt;</span> <span class="op">*</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="op">,</span> <span class="fu">.css-parallax-layer.as-base</span> {</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    <span class="kw">z-index</span>: <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>    <span class="co">/* prevents the browser flattening the `css-parallax-group` elements */</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>    <span class="kw">transform-style</span>: preserve-3d<span class="op">;</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>So if the elements are located in different depth (on Z-axis) and moving
relatively to the <code>perspective</code> will be transformed differrently.
and which is <em>literally</em> <code>real</code> parallax.</p>
<p>and <a href="https://keithclark.co.uk/articles/pure-css-parallax-websites/demo1/">THIS</a> is first demo to understand how the tranformation</p>
<h1 id="but-size-matters">But Size Matters</h1>
<p>As you can see the example above, we only care about moving speed, not transformed size,
so Keith explain it as <a href="https://keithclark.co.uk/articles/pure-css-parallax-websites/#depth-correction"><code>Depth correction</code></a>.</p>
<p>So we need to scale up if itâ€™s bellow the display plane or vice versa.
He didnâ€™t mention about how scale is calculated. (because it is maybe too simple?)
and this is a <code>poor</code> explanation.</p>
<pre class="ascii"><code>                      /â€–    â¤’
                     / â€–
                    /  â€–
                  |/   â€–
                  |    â€–
                 /|â¤’   â€–    n
                / |    â€–
               /  |m   â€–
              /   |    â€–
perspective) .____|â¤“___â€–   â¤“
                  |
                  |    â†‘ real position
                  â†‘ display plane

             â‡¤pâ‡¥ â‡¤kâ‡¥


so we can see two triangles:
                    m                         n

  small :  tan Î¸ = ---      large :  tan Î¸ = ----
                    p                        p+k

   or

  p : (p+k) = m : n

and the scale amount we need is transforming from `m` to `n` (real size)
i.e)   `n / m` is the one.
           n     (p+k)
  scale = --- = ------
           m       p

so if we set p(perspective) as 1px and k (1px:  negate of -1px)

          (1 + 1)
  scale = -------   = 2
             1</code></pre>
<h1 id="trouble-shootings">Trouble shootings</h1>
<h2 id="height-calculation-wrong">Height Calculation wrong!</h2>
<p>If seeing the screen capture bellow, we will find that the scroll
had not stopped upto the where article ended and - even worth -
scrolling kept going beyond the background as well.</p>
<figure>
<img src="../images/CssParallax-WrongHeightCalculation.png" alt="Wrong Scroll Position on Edge" /><figcaption aria-hidden="true">Wrong Scroll Position on Edge</figcaption>
</figure>
<p><em>but there is no problem on Firefox 97.0 (64-bit)</em></p>
<p>Why is this happening?
<a href="https://keithclark.co.uk/articles/pure-css-parallax-websites/#update-25-feb-2015">explanation on Keithâ€™s article</a></p>
<p>However, In my case, the calculation is wrong vertically not horizontally,
my similar solution is done by adding <code>perspective-origin</code> and <code>transform-origin</code>
as bellow.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">.css-parallax-toplevel</span> {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">/* .. snip .. */</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">/* v fix wrong calculation visual size(height) of background</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">     *   on webkit based browsers.</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">     */</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">perspective-origin</span>: <span class="dv">center</span> <span class="dv">bottom</span><span class="op">;</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">/* .. snip again .. */</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">.css-parallax-layer</span> {</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">/* .. snip .. */</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">/* v fix wrong calculation visual size(height) of background</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co">     *   on webkit based browsers.</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co">     */</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">transform-origin</span>: <span class="dv">center</span> <span class="dv">bottom</span><span class="op">;</span> <span class="co">/* X-axis, Y-axis per each */</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">/* .. snip again .. */</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>keep origin on X-axis <code>center</code> but <code>bottom</code> on Y-axis.</p>
<h2 id="more-caveat-and-bugs-explained">More caveat and bugs explained</h2>
<p>Unfortunately I donâ€™t have any iOS products, Window either.
Keith mentioned about some trouble shooting on different web browsers.</p>
<p>please find more information <a href="https://keithclark.co.uk/articles/practical-css-parallax/#browser-quirks">Here</a>.</p>
<h2 id="problem-on-vivaldi-work-in-progress">Problem on Vivaldi (Work In Progress)</h2>
<figure>
<img src="../images/CssParallax-13Mar2022.VivaldiGlitches.png" alt="Blurred Text on Vivaldi" /><figcaption aria-hidden="true">Blurred Text on Vivaldi</figcaption>
</figure>
<p>I havenâ€™t found working around yet.
<em>But If you select the text, it shows correctly.</em>
(so maybe using javascript to select individually? nahâ€¦ I guess that
a bug report required.)</p>
<h2 id="problem-on-fffirefox-for-mobile-work-in-progress">Problem on FF(Firefox) for mobile (Work In Progress)</h2>
<figure>
<img src="../images/CssParallax-13Mar2022.FirefoxAlwaysBottomMenu.jpg" alt="Bottom Menu always revealed on FF Mobile" /><figcaption aria-hidden="true">Bottom Menu always revealed on FF Mobile</figcaption>
</figure>
<p>This bug prevents for user to see content at the bottom which is,
in my opinion, serious problem.
but there is no working around, I think bug report required.</p>
<h2 id="bug-with-meta-viewport-...-initial-scale1">Bug with <code>meta viewport ... initial-scale=1</code></h2>
<p>If you are see the site with <code>Desktop Mode</code>, there is no problem on Chrome.</p>
<p>Howevery on mobile, it looks like below.
<em>Brave mobile also does the same mis-caculation.</em></p>
<p><a href="../images/CssParallax-18Mar2022.Chrome-RightHandesideCropped.jpg">Right hand side cropped on Chrome Mobile</a></p>
<h3 id="solution">solution</h3>
<p>remove any line like below</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode html"><code class="sourceCode html"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;meta</span> <span class="er">name</span><span class="ot">=</span><span class="st">&quot;viewport&quot;</span> <span class="er">content</span><span class="ot">=</span><span class="st">&quot;width=device-width, height=device-height, viewport-fit=contain, initial-scale=1&quot;</span><span class="kw">&gt;</span></span></code></pre></div>
<p>and add your own text level. my testing values are shown below so far:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a> <span class="co">/* increase the font size on portrait mode on mobile */</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">@media</span> <span class="kw">only</span> <span class="dv">screen</span> <span class="kw">and</span> (<span class="kw">pointer</span>: coarse) <span class="kw">and</span> (<span class="kw">orientation</span>: <span class="dv">portrait</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>       <span class="kw">and</span> (<span class="kw">max-width</span>: <span class="dv">992</span><span class="dt">px</span>) {</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    html<span class="op">,</span> body {</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">font-size</span>: <span class="dv">3.5</span><span class="dt">vw</span><span class="op">;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">/* but increase slightly on landscape mode on mobile */</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="im">@media</span> <span class="kw">only</span> <span class="dv">screen</span> <span class="kw">and</span> (<span class="kw">pointer</span>: coarse)  <span class="kw">and</span> (<span class="kw">orientation</span>: <span class="dv">landscape</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>       <span class="kw">and</span> (<span class="kw">max-width</span>: <span class="dv">992</span><span class="dt">px</span>) {</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    html<span class="op">,</span> body {</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">font-size</span>: <span class="dv">2</span><span class="dt">vw</span><span class="op">;</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h2 id="explanation">Explanation</h2>
<ul>
<li><p><code>only screen</code> is used to be ignored on older browsers</p></li>
<li><p>If screen size is upto medium scale the font-size as 3.5vw
(which is maximum value for chrome on android so far)
but on landscape mode, viewport normally wider, use less scaling: 2.5vw</p></li>
<li><p>(pointer: coarse) is used to detect mobile device.</p></li>
<li><p>and please donâ€™t forget to use all the font size by using <code>rem</code> or <code>em</code></p></li>
</ul>
<h1 id="conclusion">Conclusion</h1>
<p><em>quick wrapping up</em></p>
<ol type="1">
<li>pros: the effect is smoother than java script version.</li>
<li>cons: hard to debug if something goes wrong.
(typo, misunderstanding)</li>
</ol>
<p>I found that this parallax effects is still useful for basic website.
and as mobile device is getting faster and more features,
the effect techniques are also applicative on
mobile device as well.</p>
<p>However, I also found that if user made mistake on css or applying on html elements,
the user are unable to get information where the mistake is blocking the effects.
so IMHO, this is where <code>widget</code> or or even javascript helper function required.</p>
<p>And Iâ€™m going to make some widget with <a href="https://www.yesodweb.com/book/widgets">yesod</a>.</p>

    </div>

    <footer id="main-footer">
      Site proudly generated by
      <a href="http://jaspervdj.be/hakyll">Hakyll</a>
    </footer>
  </body>
</html>

<!--
    Todo:
    add basic parallax and add some gradation??
    
    -->
