<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" class="font-sans">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

    <meta name="author" content="Myoungjin Jeon">


    <meta name="description" content="Introduce how to make yesod widget by using `Literate Haskell`">


    <meta name="keywords" content="literate haskell, haskell, lhs, yesod, widget, css, parallax">


    <title>MJ's kind weird Code - Css Parallax for Yesod Widget (WIP)</title>
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Atma:wght@300;500;700&family=Barlow+Condensed:ital,wght@0,100;0,300;0,600;1,100;1,500;1,600&family=Gamja+Flower&family=Hubballi&family=Jost:ital,wght@0,100;0,300;0,500;0,800;1,100;1,300;1,500;1,800&family=Unica+One&display=swap');
    </style> 
    <link rel="stylesheet" type="text/css" href="../css/04Apr2022.css" />
    <link rel="stylesheet" type="text/css" href="../css/31Mar2022.code.css" />
  </head>
  <body class="surface-color">
    <header id="main-header">
      <div id="logo" class="font-atma primary-color">
        <a href="../">MJ's Kind Weird Code</a>
      </div>
      <div id="page-title">
        <p> ðŸ“° Css Parallax for Yesod Widget (WIP)
        </p>
      </div>
      <nav id="main-nav" class="font-menu-title">
        <a href="../">Home</a>
        <a href="../about.html">About</a>
        <a href="../contact.html">Contact</a>
        <a href="../archive.html">Archive</a>
      </nav>
    </header>

    <div id="content" class="font-friendly">
            <div class="info">
    Posted on March 27, 2022
    
        by Myoungjin Jeon
    
</div>
<div class="info">
  
  Tags: 
  
</div>

<p><strong>This module applys css parallax on Yesod by creating Yesod widget</strong>.</p>
<p>And article written in <a href="https://wiki.haskell.org/Literate_programming">Literate Haskell</a>.</p>
<p>In other words, this article in raw format(<em>.lhs</em>) could be actually used in <code>yesod</code>.</p>
<p>If you are not familar with yesod, you might need to get more information from:
<a href="https://www.yesodweb.com/">yesod website</a>.</p>
<pre><code>Table of Contents
- Synopsis (How to use)
  - Precaution
  - Example Code
- Css Parallax Expalnation
- About Yesod Widget
  - Benefit
  - Widget type and Snippet Code.

- Making Widget
  - Data structure for the widget
    (data of which the widget consists)
  - Add css codes(Lucius) for parallax effect
  - Html (Hamlet)</code></pre>
<h1 id="synopsis-how-to-use">Synopsis (How to use)</h1>
<h2 id="precaution">Precaution</h2>
<ul>
<li><p>This module only get tested under <a href="https://www.yesodweb.com/book/scaffolding-and-the-site-template">yesod-scaffold</a></p></li>
<li><p>Please remove any padding in the container for <code>css-parallax-toplevel-#{classSurfix}</code>
which includes <code>gap</code> for the grid display type.
the basic box-sizing and border, padding are like below:
(if you donâ€™t include those, you will see unexpected padding
around the <code>div</code>)</p></li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode css"><code class="sourceCode css"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="op">*</span> <span class="op">,</span> <span class="op">*</span><span class="in">::after</span><span class="op">,</span> <span class="op">*</span><span class="in">::before</span> {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">box-sizing</span>:<span class="dv">border-box</span><span class="op">;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">border</span>: <span class="dv">0</span><span class="op">;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">padding</span>: <span class="dv">0</span><span class="op">;</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>NOTE:</strong> Above settings is NOT included in the Widget.</p>
<h1 id="example-code">Example Code</h1>
<p>the following code shows how to use the widget.</p>
<p><em>Note: there are some pseudo function or css class name</em></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ot">getHomeR ::</span> <span class="dt">Handler</span> <span class="dt">Html</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>getHomeR <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    (formWidget, formEnctype) <span class="ot">&lt;-</span> generateFormPost sampleForm</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    parallaxSurfix <span class="ot">&lt;-</span> newIdent</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    master <span class="ot">&lt;-</span> getYesod <span class="co">-- required to get copyright information</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> submission <span class="ot">=</span> <span class="dt">Nothing</span><span class="ot"> ::</span> <span class="dt">Maybe</span> <span class="dt">FileForm</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>        handlerName <span class="ot">=</span> <span class="st">&quot;getHomeR&quot;</span><span class="ot"> ::</span> <span class="dt">Text</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>        parallaxSettings <span class="ot">=</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>          <span class="dt">CssParallaxSettings</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>          { classSurfix <span class="ot">=</span> parallaxSurfix</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>          , perspective <span class="ot">=</span> <span class="dt">PixelSize</span> <span class="op">.</span> <span class="fu">toRational</span> <span class="op">$</span> (<span class="dv">100</span><span class="ot"> ::</span> <span class="dt">Integer</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>          , globalBgSpeed <span class="ot">=</span> <span class="dt">Speed</span> <span class="op">$</span> <span class="dv">1</span> <span class="op">:%</span> <span class="dv">5</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>          , customTopLevelClasses <span class="ot">=</span> <span class="dt">CssClasses</span> []<span class="co">-- [ &quot;body-grid-column-template&quot; ]</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>          , mbSkirtClasses <span class="ot">=</span> <span class="dt">Nothing</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>          , mbFooterContent <span class="ot">=</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>              <span class="dt">Just</span> <span class="op">$</span> toWidget <span class="op">$</span>(hamletFile <span class="st">&quot;templates/toplevel-footer.hamlet&quot;</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>          , parallaxGroups <span class="ot">=</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>              [ <span class="dt">CssParallaxGroup</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>                { groupId <span class="ot">=</span> <span class="st">&quot;intro&quot;</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>                , customCssClasses <span class="ot">=</span> <span class="dt">CssClasses</span> []<span class="co">{-[ &quot;whole-grid-column&quot;</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="co">                                                -- ^ use whole area of topLevel</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="co">                                                , &quot;body-grid-column-template&quot;</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="co">                                                ]-}</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>                , parallaxClasses <span class="ot">=</span> <span class="dt">CssClasses</span> []<span class="co">{-[ &quot;whole-grid-column&quot;</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a><span class="co">                                               -- ^ use whole area of group</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="co">                                               ]-}</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>                , mbBgSpeed <span class="ot">=</span> <span class="dt">Nothing</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>                , bgStaticRoute <span class="ot">=</span> img_cafeblossom_grey_webp</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>                                  <span class="co">-- ^ from Settings/StaticFiles.hs</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>                , titleContainerClasses <span class="ot">=</span> <span class="dt">CssClasses</span> []<span class="co">-- [ &quot;main-grid-area&quot; ]</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>                , titleContent <span class="ot">=</span> toWidget [hamlet|</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>                                             <span class="kw">&lt;h1&gt;</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>                                               Better Coffee Now</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>                                          |]</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>                , moreContents <span class="ot">=</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>                    [</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a> <span class="op">#</span>if <span class="dt">PRODUCTION</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>                      toWidget <span class="op">$</span>(hamletFile <span class="st">&quot;templates/home-main.hamlet&quot;</span>)</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>                      <span class="co">-- we can add more .. ??</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a> <span class="op">#</span>else</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>                      toWidget <span class="op">$</span>(hamletFileReload <span class="st">&quot;templates/home-main.hamlet&quot;</span>)</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a> <span class="op">#</span>endif</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>                    ]</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>              ]</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>           }</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>    defaultLayout <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>      <span class="co">--let (commentFormId, commentTextareaId, commentListId) = commentIds</span></span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>        <span class="co">-- ^ load extra css</span></span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>        setTitle <span class="st">&quot;Cafe Blossom&quot;</span></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a> <span class="op">#</span>if <span class="dt">PRODUCTION</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>        toWidgetHead <span class="op">$</span>(luciusFile <span class="st">&quot;templates/homepage.lucius&quot;</span>)</span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a> <span class="op">#</span>else</span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>        toWidgetHead <span class="op">$</span>(luciusFileReload <span class="st">&quot;templates/homepage.lucius&quot;</span>)</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a> <span class="op">#</span>endif</span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>        parallaxWidget parallaxSettings</span></code></pre></div>
<hr />
<h1 id="css-parallax-explanation">Css Parallax Explanation</h1>
<ul>
<li><p><a href="https://keithclark.co.uk/articles/pure-css-parallax-websites">The original css parallax article</a> by Keith Clark</p></li>
<li><p><a href="../posts/2022-03-12-css-parallax-revised.html">Revised article on my blog</a></p></li>
</ul>
<p>concisely, to get 3d transformation we need:</p>
<p><em>three elements with some attributes which are:</em></p>
<pre><code>    1. base element and a perspective from where we see the object on the page.
       (which is generally not moving during transformation)
    2. an anchor element(normally div) contains the elements which is actually
       tranformed.
    3. transformation origin (default is the center of the anchor element)</code></pre>
<h1 id="about-yesod-widget">About Yesod Widget</h1>
<p>Please read this <a href="https://www.yesodweb.com/book/widgets">online book</a></p>
<h2 id="benefit">Benefit</h2>
<ul>
<li>we could build a set of Html, Javascript, Css in one module</li>
<li>combine with others easily later</li>
<li>without thinking of monolithic structure of html</li>
</ul>
<p>and last but not least,</p>
<ul>
<li>parameterize your widget by using template interpolation</li>
</ul>
<p>Firstly, We need to use some haskell extensions.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ot">{-# LANGUAGE QuasiQuotes #-}</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="ot">{-# LANGUAGE OverloadedStrings #-}</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="ot">{-# LANGUAGE RecordWildCards   #-}</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="ot">{-# LANGUAGE TypeFamilies #-}</span></span></code></pre></div>
<p><code>QuasiQuotes</code> required for [hamlet| â€¦ |] style syntax</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">module</span> <span class="dt">Widget.CssParallax</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>   ( <span class="dt">CssParallaxSettings</span> (<span class="op">..</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>   , <span class="dt">CssParallaxGroup</span> (<span class="op">..</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>   , <span class="dt">CssClassesType</span> (<span class="op">..</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>   , <span class="dt">ClassSurfix</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>   , <span class="dt">SpeedType</span> (<span class="op">..</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>   , <span class="dt">ScaleType</span> (<span class="op">..</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>   , parallaxWidget</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>   ) <span class="kw">where</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="dt">Data.Text</span> (<span class="dt">Text</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Data.Maybe</span> <span class="kw">as</span> <span class="dt">Maybe</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Data.Text</span> <span class="kw">as</span> <span class="dt">T</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="dt">Yesod.Core</span> (<span class="dt">HandlerSite</span>, <span class="dt">MonadWidget</span>)</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="dt">Yesod.Core.Types</span> (<span class="dt">WidgetFor</span>)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="dt">Yesod.Core.Widget</span> (whamlet, toWidget, <span class="dt">CssBuilder</span>(..))</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="dt">Yesod.Static</span> (<span class="dt">StaticRoute</span>)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="dt">Text.Lucius</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="dt">Text.Blaze</span> (<span class="dt">ToMarkup</span>, toMarkup)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="dt">Foundation</span></span></code></pre></div>
<p>Foundataion in yesod-scaffold creates data type <code>App</code>, <code>Widget</code>, Handlers
(including <code>StaticR</code> which is used for css <code>bacgkground-image</code> here)</p>
<p>## Widget type and Snippet Code.</p>
<p>Whether we are creating from quasi quotes or loading from file,
results in Widget data type.</p>
<p>from yesodweb.com ther is an example for lucius (template lang for css)</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ot">footer ::</span> <span class="dt">Widget</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>footer <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>   toWidget</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>     [lucius|</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>         footer {</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>             font-weight: bold;</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>             text-align: center;</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>         }</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>     ]</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>   toWidget</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>     [hamlet|</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>       &lt;footer&gt;</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>         &lt;p&gt;That's all folks!</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>     |]</span></code></pre></div>
<p>So we can later interpolate with other Widgets like:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ot">page ::</span> <span class="dt">Widget</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>page <span class="ot">=</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  [whamlet|</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>      <span class="kw">&lt;p&gt;</span>This is my page. I hope you enjoyed it.</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>      <span class="kw">^{</span>footer<span class="kw">}</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  |]</span></code></pre></div>
<p>Suprisingly, we donâ€™t ned to worry about mixed template lanuages.
Above code use Html(Hamlet) and Css(Lucius) at the same time.</p>
<p>So basically every element could be a <code>Widget</code>.</p>
<p>We can load our widget(s) later, which is explained in:
<a href="https://www.yesodweb.com/book/widgets#widgets_using_widgets">here</a></p>
<h2 id="making-widget">Making Widget</h2>
<p>Now Letâ€™s have a look in to the previous example as an <code>Yesod Widget</code>.
This widget consists of Html and Css only, so we will see how
to create an widget with Hamlet and Cacius</p>
<h2 id="data-structure-for-the-widget">Data structure for the widget</h2>
<p>I am going to put in the page:</p>
<ul>
<li>class name prefix</li>
<li>background image (as StaticRoute)</li>
<li>title contents (with no parllax effect)</li>
<li>main contents after the image
(normally has the background color)</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">type</span> <span class="dt">ClassSurfix</span> <span class="ot">=</span> <span class="dt">Text</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> <span class="dt">CssParallaxSettings</span> site <span class="ot">=</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">CssParallaxSettings</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  {<span class="ot"> classSurfix           ::</span> <span class="dt">ClassSurfix</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  ,<span class="ot"> customTopLevelClasses ::</span> <span class="dt">CssClassesType</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  ,<span class="ot"> perspective           ::</span> <span class="dt">PixelSize</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  ,<span class="ot"> globalBgSpeed         ::</span> <span class="dt">SpeedType</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  ,<span class="ot"> mbSkirtClasses        ::</span> <span class="dt">Maybe</span> <span class="dt">CssClassesType</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  ,<span class="ot"> parallaxGroups        ::</span> [<span class="dt">CssParallaxGroup</span> site]</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  ,<span class="ot"> absParallaxItems      ::</span> [<span class="dt">AbsCssParallaxItem</span> site]</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  ,<span class="ot"> mbFooterContent       ::</span> <span class="dt">Maybe</span> (<span class="dt">WidgetFor</span> site ())</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co">-- | each group can have different background and parallax speed.</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> <span class="dt">CssParallaxGroup</span> site <span class="ot">=</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="dt">CssParallaxGroup</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  {<span class="ot"> groupId                     ::</span> <span class="dt">ParallaxGroupId</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">-- ^ used for unique css class name</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  ,<span class="ot"> grpCustomCssClasses         ::</span> <span class="dt">CssClassesType</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">-- ^ this is custom css classes for styling</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  ,<span class="ot"> grpParallaxClasses          ::</span> <span class="dt">CssClassesType</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">-- ^ about parallax object specific styling</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  ,<span class="ot"> mbGrpBgSpeed                ::</span> <span class="dt">Maybe</span> <span class="dt">SpeedType</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  ,<span class="ot"> grpBgStaticRoute            ::</span> <span class="dt">StaticRoute</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  ,<span class="ot"> grpTitleContainerClasses    ::</span> <span class="dt">CssClassesType</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>  ,<span class="ot"> grpTitleContent             ::</span> <span class="dt">WidgetFor</span> site ()</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  ,<span class="ot"> grpMoreContents             ::</span> [<span class="dt">WidgetFor</span> site()]</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="co">-- | Some parallax items can has 'absolute' position and moving at different</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="co">--   speed. (normally used for faster-moving elements)</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a><span class="kw">data</span> <span class="dt">AbsCssParallaxItem</span> site <span class="ot">=</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>  <span class="dt">AbsCssParallaxItem</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>  {<span class="ot"> itemId                ::</span> <span class="dt">ParallaxItemId</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>  ,<span class="ot"> customItemCssClasses  ::</span> <span class="dt">CssClassesType</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>  ,<span class="ot"> itemSpeed             ::</span> <span class="dt">SpeedType</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>  ,<span class="ot"> itemContent           ::</span> <span class="dt">WidgetFor</span> site ()</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>  }</span></code></pre></div>
<h2 id="make-some-type-alias-for-more-readable-form-of-declaration">Make some type alias for more readable form of declaration</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- | alias for parallax group or item Id</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="kw">type</span> <span class="dt">ParallaxGroupId</span> <span class="ot">=</span> <span class="dt">Text</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="kw">type</span> <span class="dt">ParallaxItemId</span>  <span class="ot">=</span> <span class="dt">Text</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="kw">newtype</span> <span class="dt">CssClassesType</span> <span class="ot">=</span> <span class="dt">CssClasses</span> {<span class="ot"> getCssClasses ::</span> [<span class="dt">Text</span>] }</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">-- |  join all the classes with &quot; &quot; to use inside tag &lt; .. class=&quot;&lt;Here&gt;&quot; &gt;</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="kw">instance</span> <span class="dt">Show</span> <span class="dt">CssClassesType</span> <span class="kw">where</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">show</span> (<span class="dt">CssClasses</span> ts) <span class="ot">=</span> (<span class="fu">show</span> <span class="op">.</span> T.unwords) ts</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="kw">instance</span> <span class="dt">ToCss</span> <span class="dt">CssClassesType</span> <span class="kw">where</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  toCss (<span class="dt">CssClasses</span> ccs) <span class="ot">=</span> toCss <span class="op">.</span> T.unwords <span class="op">$</span> ccs</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="kw">instance</span> <span class="dt">ToMarkup</span> <span class="dt">CssClassesType</span> <span class="kw">where</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  toMarkup (<span class="dt">CssClasses</span> ccs) <span class="ot">=</span> toMarkup <span class="op">.</span> T.unwords <span class="op">$</span> ccs</span></code></pre></div>
<p>However, the below code got complained:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">type</span> <span class="dt">SpeedType</span> <span class="ot">=</span> <span class="dt">Rational</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="kw">type</span> <span class="dt">Scaletype</span> <span class="ot">=</span> <span class="dt">Rational</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="kw">instance</span> (<span class="dt">Show</span> a, <span class="dt">Real</span> a) <span class="ot">=&gt;</span> <span class="dt">ToCss</span> (<span class="dt">Ratio</span> a) <span class="kw">where</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  toCss x <span class="ot">=</span> toCss <span class="op">.</span> <span class="fu">show</span> <span class="op">$</span> x</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">keyword:</span> warningOrphans</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Orphan</span> instance: instance <span class="er">(</span><span class="ex">Show</span> a, Real a<span class="kw">)</span> <span class="ex">=</span><span class="op">&gt;</span> ToCss <span class="er">(</span><span class="ex">Ratio</span> a<span class="kw">)</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="ex">To</span> avoid this</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>        <span class="ex">move</span> the instance declaration to the module of the class or of the type, or</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>        <span class="ex">wrap</span> the type with a newtype and declare the instance on the new type.</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="ex">XXX</span> <span class="kw">|</span> <span class="op">&gt;</span> instance <span class="kw">(</span><span class="ex">Show</span> a, Real a<span class="kw">)</span> <span class="ex">=</span><span class="op">&gt;</span> ToCss <span class="er">(</span><span class="ex">Ratio</span> a<span class="kw">)</span> <span class="ex">where</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">|</span>   <span class="ex">^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span> ...</span></code></pre></div>
<p>So I change to</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">newtype</span> <span class="dt">SpeedType</span> <span class="ot">=</span> <span class="dt">Speed</span> <span class="dt">Rational</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="kw">newtype</span> <span class="dt">ScaleType</span> <span class="ot">=</span> <span class="dt">Scale</span> <span class="dt">Rational</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="kw">instance</span> <span class="dt">ToCss</span> <span class="dt">ScaleType</span> <span class="kw">where</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  toCss (<span class="dt">Scale</span> s) <span class="ot">=</span> toCss <span class="op">.</span> (<span class="fu">show</span><span class="ot"> ::</span> <span class="dt">Float</span> <span class="ot">-&gt;</span> <span class="dt">String</span>) <span class="op">.</span> <span class="fu">fromRational</span> <span class="op">$</span> s</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="kw">instance</span> <span class="dt">ToCss</span> <span class="dt">SpeedType</span> <span class="kw">where</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  toCss (<span class="dt">Speed</span> s) <span class="ot">=</span> toCss <span class="op">.</span> (<span class="fu">show</span><span class="ot"> ::</span> <span class="dt">Float</span> <span class="ot">-&gt;</span> <span class="dt">String</span>) <span class="op">.</span> <span class="fu">fromRational</span> <span class="op">$</span> s</span></code></pre></div>
<p>To avoid class naming colision, you can add <code>ClassSurfix</code> via <code>newIdent</code>.</p>
<p><a href="https://www.yesodweb.com/book/widgets#widgets_generate_ids">learn more</a></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- |  Return the appropriate value for translateZ by given perspective and</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- scale value.</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">-- Original apporach:</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">--   set translateZ value -&gt; make scale value</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">-- New approach:</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co">--    set scale value -&gt; make translateZ value</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co">--</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co">-- Because more scale means less moving speed</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co">--      h  : transformed height</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co">--      h' : original height</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co">--      p  : perspective value</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co">--      z  : translated value on Z-axis</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co">--</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a><span class="co">-- &gt;         h : h' = p : p + |z|</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co">-- &gt;</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="co">-- &gt;                h'     (p+|z|)</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="co">-- &gt;        scale = ----  = -------</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="co">-- &gt;                 h         p</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="co">-- &gt;</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a><span class="co">-- &gt;       |z| = p * scale - p = p * (scale - 1)</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="ot">getTranslateZpixel ::</span> <span class="dt">PixelSize</span> <span class="ot">-&gt;</span> <span class="dt">ScaleType</span> <span class="ot">-&gt;</span> <span class="dt">PixelSize</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>getTranslateZpixel (<span class="dt">PixelSize</span> perspecVal) (<span class="dt">Scale</span> scaleVal) <span class="ot">=</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>  <span class="dt">PixelSize</span> <span class="op">.</span> <span class="fu">toRational</span> <span class="op">.</span> <span class="fu">negate</span> <span class="op">$</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>  (<span class="fu">fromRational</span><span class="ot"> perspecVal ::</span> <span class="dt">Float</span>) <span class="op">*</span> (scaleVal' <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>  <span class="kw">where</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>    scaleVal' <span class="ot">=</span> <span class="fu">fromRational</span><span class="ot"> scaleVal ::</span> <span class="dt">Float</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a><span class="co">-- |  Create a main widget with 100% covered background with contents</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a><span class="co">-- </span><span class="al">TODO</span><span class="co">: parameterize horizontal cover size</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a><span class="ot">parallaxWidget ::</span> (<span class="dt">MonadWidget</span> m, <span class="dt">HandlerSite</span> m <span class="op">~</span> <span class="dt">App</span>) <span class="ot">=&gt;</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>  <span class="dt">CssParallaxSettings</span> <span class="dt">App</span> <span class="ot">-&gt;</span> m ()</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>parallaxWidget <span class="dt">CssParallaxSettings</span>{<span class="op">..</span>} <span class="ot">=</span> <span class="kw">do</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span><span class="ot"> bgScaleFromSpeed ::</span> <span class="dt">SpeedType</span> <span class="ot">-&gt;</span> <span class="dt">ScaleType</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>      bgScaleFromSpeed (<span class="dt">Speed</span> spd)</span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>        <span class="op">|</span> spd <span class="op">==</span> <span class="dv">0</span> <span class="ot">=</span> <span class="dt">Scale</span> <span class="op">.</span> <span class="fu">toRational</span> <span class="op">$</span> (<span class="dv">999999999999999</span><span class="ot"> ::</span> <span class="dt">Integer</span>)</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>        <span class="op">|</span> <span class="fu">otherwise</span> <span class="ot">=</span> <span class="dt">Scale</span> <span class="op">$</span> <span class="dv">1</span> <span class="op">/</span> spd</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>      globalBgScale <span class="ot">=</span> bgScaleFromSpeed globalBgSpeed</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>      translateZpx spd <span class="ot">=</span></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>        (getTranslateZpixel perspective) <span class="op">.</span> bgScaleFromSpeed <span class="op">$</span> spd</span></code></pre></div>
<h2 id="about-luciusmixin">About luciusMixin</h2>
<p><a href="https://www.yesodweb.com/book/shakespearean-templates#shakespearean-templates_lucius_syntax">Online Book</a></p>
<p>Some properties can be parameterized and less mistakes expected when writing css.
For example, using <code>transform</code> and <code>-webkit-transform</code> with same property value.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- v will be interpolated in the follwing `toWidget`</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>      transformForPallaxMixin sp <span class="ot">=</span> [luciusMixin|</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>      transform: translateZ(#{translateZpx sp}) scale(#{bgScaleFromSpeed sp});</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>       -webkit-transform: translateZ(#{translateZpx sp}) scale(#{bgScaleFromSpeed sp});</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>       |]</span></code></pre></div>
<p>However above mixin value depends on speed value from each different group.
we need to concatenate all the settings. which is done by easily,
because Mixin is a Monoid.</p>
<p>So letâ€™s make a list of pair of ParallaxGroupId =&gt; SpeedType</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>      parallaxGroupIdToSpeed <span class="ot">=</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">map</span> (\<span class="dt">CssParallaxGroup</span>{<span class="op">..</span>} <span class="ot">-&gt;</span> (groupId, mbBgSpeed)) parallaxGroups</span></code></pre></div>
<p>But probably map with <strong>global</strong> background speed and is better idea.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="ot">      parallaxGroupWithGlobalSpeed ::</span> [(<span class="dt">ParallaxGroupId</span>, <span class="dt">SpeedType</span>, <span class="dt">StaticRoute</span>)]</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>      parallaxGroupWithGlobalSpeed <span class="ot">=</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">map</span> (\<span class="dt">CssParallaxGroup</span>{<span class="op">..</span>} <span class="ot">-&gt;</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                (groupId</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                , <span class="dt">Maybe</span><span class="op">.</span><span class="fu">maybe</span> globalBgSpeed <span class="fu">id</span> mbBgSpeed</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>                , bgStaticRoute</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>            parallaxGroups</span></code></pre></div>
<p>One more thing I would like to mention is that
all this settings for parllax speed (which is related to transformation scale)
and background is reuquired to remain inside of <code>@supports</code> block.
However <code>@supports</code> block is unable to get mixin directly in its block,
we need to make a separate lucius block and will be applied later.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>      <span class="co">-- | set up transformation and background for each group</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>      applyAllGroupsParallaxSetup <span class="ot">=</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">foldr</span> (<span class="op">&gt;&gt;</span>) (toWidget <span class="op">$</span> <span class="dt">CssBuilder</span> <span class="st">&quot;&quot;</span>) <span class="op">$</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">map</span> (\(gid, spd, bgRoute) <span class="ot">-&gt;</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>               toWidget [lucius|</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>                          ##{gid} &gt; .as-parallax {</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>                            ^{transformForPallaxMixin spd}</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>                            width: min(105%, 100vw);</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>                            height: 100%; /* we need to set the size on grid setting*/</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>                            box-sizing: border-box;</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>                            background-image: url( @{StaticR bgRoute} );</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>                            background-repeat: repeat;</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>                            background-size: cover;</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>                            background-position: center;</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>                          }</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>                        |]</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>            ) parallaxGroupWithGlobalSpeed</span></code></pre></div>
<p>This is another mixin example for duplicated properties.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>      transformForFixingSafariHWAccelMixin <span class="ot">=</span> [luciusMixin|</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>        transform: translateZ(1e-12px);</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>       -webkit-transform: translateZ(1e-12px);</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>      |]</span></code></pre></div>
<p>Instead of some comments you can use meaningful function name.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>      gridUseAllColumnsMixin <span class="ot">=</span> [luciusMixin|grid-column: 1 / -1;|]</span></code></pre></div>
<p>Grid setup is useful when custom layout applied through <code>customTopLevelClasses</code>,
<code>groupClasses</code>, etc.</p>
<p>The main elements are <code>parallax groups</code> a.k.a <code>slides</code>.
And also after last group finished, we need an extra <code>div</code> to fill up
empty space (especially we have more contents after last background)
And lastly, if you need any footer for your web page, footer should be
inside of toplevel because toplevel handles overflow here.</p>
<p>However, groups could be more than one, we are unable to specify the
grid row names, so you might need to specify only how many rows it will consume</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode haskell"><code class="sourceCode haskell"></code></pre></div>
<p>Each group contains:</p>
<ol type="1">
<li>a parallax object (background image)
<em>could be improve with multiple parallax object</em></li>
<li>cover (normally used for title)</li>
<li>group contents</li>
</ol>
<p>So, grid template looks like:</p>
<p><em>TODO</em> : parameterize cover height</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>      gridTemplateGroupMixin <span class="ot">=</span> [luciusMixin|</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>        grid-template-rows:</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>          [cp-rtop cp-prlx-rtop cp-bs-rtop] 100vh</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>          [cp-prlx-rbtm cp-bs-rbtm cp-bs-extra-rtop] auto</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>          [cp-bs-extra-rbtm cp-rbtm];</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>        |]</span></code></pre></div>
<p>rtop: row top, rbtm: row bottom, prlx: parllax, bs: base(no parallax) relatively.
For basic setup background and cover share the same area.</p>
<p>You can also parameterize the your mixin</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="ot">      gridUseAllRowsNamedMixin ::</span> <span class="dt">Text</span> <span class="ot">-&gt;</span> <span class="dt">Mixin</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>      gridUseAllRowsNamedMixin rowName <span class="ot">=</span> [luciusMixin|</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>        grid-row: cp-#{rowName}-rtop / cp-#{rowName}-rbtm;</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>      |]</span></code></pre></div>
<p>Typeclass like <code>PixelSize</code> is amazing when you use cacius or lucius
PixelSize is a <code>Num</code> so you can add any <code>Num</code> but when tranlated into
Css, which is appened by â€œpxâ€ string.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>      fixiOSCaveatMixin <span class="ot">=</span> [luciusMixin|</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>        perspective: #{perspective + 1};</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>      |]</span></code></pre></div>
<p>To apply(append) custom css classes, I made one more little mixin</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="ot">      appendCssClasses ::</span> <span class="dt">CssClassesType</span> <span class="ot">-&gt;</span> <span class="dt">String</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>      appendCssClasses ccs</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>        <span class="op">|</span> <span class="fu">null</span> (getCssClasses ccs) <span class="ot">=</span> <span class="st">&quot;&quot;</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>        <span class="op">|</span> <span class="fu">otherwise</span> <span class="ot">=</span> <span class="st">&quot; &quot;</span> <span class="op">&lt;&gt;</span> (<span class="fu">show</span> ccs)</span></code></pre></div>
<p>And the following code is for the css partâ€¦</p>
<h2 id="add-css-codeslucius-for-parallax-effect">Add css codes(Lucius) for parallax effect</h2>
<div class="sourceCode" id="cb26"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>  toWidget [lucius|</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>.css-parallax-toplevel-#{classSurfix} {</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  height: 500px; /* fallback for older browser */</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  height: 100%;</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  width: 100%;</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  overflow-x: hidden;</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  overflow-y: auto;</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  margin: 0;</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  padding: 0;</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  display: grid;</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>.css-parallax-group-#{classSurfix} {</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    ^{gridUseAllColumnsMixin}</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>    display: grid;</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>    ^{gridTemplateGroupMixin}</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>.css-parallax-layer-#{classSurfix} {</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>    ^{gridUseAllColumnsMixin}</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    transform-origin: center bottom;</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>.css-parallax-layer-#{classSurfix}.as-parallax {</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>    /* set another background division after the original background */</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>    /* this is normally for simple background setup for content</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>     * which is not parallaxed */</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>    ^{gridUseAllRowsNamedMixin &quot;prlx&quot;}</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>.css-parallax-layer-#{classSurfix}.as-base {</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>    ^{gridUseAllRowsNamedMixin &quot;bs&quot;}</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>.css-parallax-layer-#{classSurfix}.as-base-extra {</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>    ^{gridUseAllRowsNamedMixin &quot;bs-extra&quot;}</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>.css-parallax-item-#{classSurfix} {</span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>    position: absolute;</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>.css-parallax-toplevel-#{classSurfix} &gt; .css-parallax-background-skirt-#{classSurfix} {</span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>    ^{gridUseAllColumnsMixin}</span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>    grid-row: span 1;</span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>/*    ^{gridUseSkirtRowMixin}*/</span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>.css-parallax-toplevel-footer-#{classSurfix} {</span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>    ^{gridUseAllColumnsMixin}</span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>    grid-row: span 1;</span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>.css-parallax-toplevel-#{classSurfix} + div {</span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>    /* credit: The Safari and iOS Caveat on https://orangeable.com/css/parallax-scroll */</span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>    /* jeongoon: haven't tested. no iPad or Macbook :-/ */</span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a>    /* Safari / iOS issue with `overflow: hidden` is not working</span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a>     * in the `css-parallax-toplevel` */</span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a>    ^{fixiOSCaveatMixin}</span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a>@supports ((perspective: 1px) and (not (-webkit-overflow-scrolling: touch))) {</span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a>    body {</span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a>        transform: translateZ(0px);</span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a>        /* ^ Fix paint issues in Edge &amp; Safari H/W accel */</span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-60"><a href="#cb26-60" aria-hidden="true" tabindex="-1"></a>    .css-parallax-toplevel-#{classSurfix} {</span>
<span id="cb26-61"><a href="#cb26-61" aria-hidden="true" tabindex="-1"></a>        perspective: #{perspective};</span>
<span id="cb26-62"><a href="#cb26-62" aria-hidden="true" tabindex="-1"></a>       /* v fix wrong calculation visual size(height) of background</span>
<span id="cb26-63"><a href="#cb26-63" aria-hidden="true" tabindex="-1"></a>        *   on webkit based browsers.</span>
<span id="cb26-64"><a href="#cb26-64" aria-hidden="true" tabindex="-1"></a>        */</span>
<span id="cb26-65"><a href="#cb26-65" aria-hidden="true" tabindex="-1"></a>       perspective-origin: center bottom;</span>
<span id="cb26-66"><a href="#cb26-66" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb26-67"><a href="#cb26-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-68"><a href="#cb26-68" aria-hidden="true" tabindex="-1"></a>    .css-parallax-toplevel-#{classSurfix} &gt; *</span>
<span id="cb26-69"><a href="#cb26-69" aria-hidden="true" tabindex="-1"></a>    , .css-parallax-layer-#{classSurfix}.as-base</span>
<span id="cb26-70"><a href="#cb26-70" aria-hidden="true" tabindex="-1"></a>    , .css-parallax-layer-#{classSurfix}.as-base-extra {</span>
<span id="cb26-71"><a href="#cb26-71" aria-hidden="true" tabindex="-1"></a>        z-index: 1;</span>
<span id="cb26-72"><a href="#cb26-72" aria-hidden="true" tabindex="-1"></a>        /* prevents the browser flattening the `css-parallax-layer` elements */</span>
<span id="cb26-73"><a href="#cb26-73" aria-hidden="true" tabindex="-1"></a>        transform-style: preserve-3d;</span>
<span id="cb26-74"><a href="#cb26-74" aria-hidden="true" tabindex="-1"></a>        /* v ensure Safari H/W acceleration */</span>
<span id="cb26-75"><a href="#cb26-75" aria-hidden="true" tabindex="-1"></a>        ^{transformForFixingSafariHWAccelMixin}</span>
<span id="cb26-76"><a href="#cb26-76" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb26-77"><a href="#cb26-77" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-78"><a href="#cb26-78" aria-hidden="true" tabindex="-1"></a>|]</span>
<span id="cb26-79"><a href="#cb26-79" aria-hidden="true" tabindex="-1"></a>  applyAllGroupsParallaxSetup</span></code></pre></div>
<h2 id="html-hamlet">Html (Hamlet)</h2>
<p>And finally this is Html part for actual displaying layout.
Please have a look <code>gridTemplateToplevelMixin</code> and <code>gridTemplateGroupMixin</code>
for the structure.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode haskell literate"><code class="sourceCode haskell"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>  toWidget [whamlet|</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;div </span><span class="er">class=&quot;css-parallax-toplevel-#{classSurfix}#{appendCssClasses</span><span class="kw"> </span><span class="er">customTopLevelClasses}&quot;</span><span class="kw">&gt;</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">$if</span> <span class="fu">null</span> parallaxGroups</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;div&gt;</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>      No parallaxGroups: Please Check you parallaxGroups</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">$else</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">$forall</span> pg <span class="ot">&lt;-</span> parallaxGroups</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>      <span class="kw">&lt;div </span><span class="er">id=&quot;#{groupId</span><span class="kw"> </span><span class="er">pg}&quot;</span><span class="kw"> </span><span class="er">class=&quot;css-parallax-group-#{classSurfix}#{appendCssClasses</span><span class="kw"> </span><span class="er">(grpCustomCssClasses</span><span class="kw"> </span><span class="er">pg)}&quot;</span><span class="kw">&gt;</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">&lt;div </span><span class="er">class=&quot;css-parallax-layer-#{classSurfix}</span><span class="kw"> </span><span class="er">as-parallax#{appendCssClasses</span><span class="kw"> </span><span class="er">(grpParallaxClasses</span><span class="kw"> </span><span class="er">pg)}&quot;</span><span class="kw">&gt;</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">&lt;div </span><span class="er">class=&quot;css-parallax-layer-#{classSurfix}</span><span class="kw"> </span><span class="er">as-base#{appendCssClasses</span><span class="kw"> </span><span class="er">(grpTitleContainerClasses</span><span class="kw"> </span><span class="er">pg)}&quot;</span><span class="kw">&gt;</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>          <span class="kw">^{</span>grpTitleContent pg<span class="kw">}</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>        <span class="kw">&lt;div </span><span class="er">class=&quot;css-parallax-layer-#{classSurfix}</span><span class="kw"> </span><span class="er">as-base-extra&quot;</span><span class="kw">&gt;</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>            <span class="kw">$forall</span> moreContent <span class="ot">&lt;-</span> (grpMoreContents pg)</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>              <span class="kw">^{</span>moreContent<span class="kw">}</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>      <span class="kw">$forall</span> <span class="fu">pi</span> <span class="ot">&lt;-</span> absParallaxItems</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">&lt;div </span><span class="er">id=&quot;#{itemId</span><span class="kw"> </span><span class="er">pi}&quot;</span><span class="kw"> </span><span class="er">class=&quot;css-parallax-item-#{classSurfix}#{appendCssClasses</span><span class="kw"> </span><span class="er">(customItemCssClasses</span><span class="kw"> </span><span class="er">pi)}&quot;</span><span class="kw">&gt;</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>          <span class="kw">^{</span>itemContent <span class="fu">pi</span><span class="kw">}</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>  <span class="kw">$maybe</span> skirtClasses <span class="ot">&lt;-</span> mbSkirtClasses</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;div </span><span class="er">class=&quot;css-parallax-background-skirt-#{classSurfix}#{appendCssClasses</span><span class="kw"> </span><span class="er">skirtClasses</span><span class="kw"> </span><span class="er">}&quot;</span><span class="kw">&gt;</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>  <span class="kw">$maybe</span> footerContent <span class="ot">&lt;-</span> mbFooterContent</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">&lt;div </span><span class="er">class=&quot;css-parallax-toplevel-footer-#{classSurfix}&quot;</span><span class="kw">&gt;</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>      <span class="kw">^{</span>footerContent<span class="kw">}</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>|]</span></code></pre></div>
<h2 id="about-my-literate-haskell-usage">About My Literate Haskell Usage</h2>
<p>When ghc is compling literate haskell file and if something goes wrong,
it doesnâ€™t suggest what to do next. And if there is one line ghc cannot
understand it will just spit out the error messages like below.</p>
<p>this is a capture for literate pre-processor typo error messages</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="ex">src/Widget/CssParallax.lhs</span> line 502: unlit: Program line next to comment</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="ex">src/Widget/CssParallax.lhs</span> line 504: unlit: Program line next to comment</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="ex">/.../..../src/Widget/CssParallax.lhs:1:1:</span> error:</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">`</span><span class="ex">unlit</span><span class="st">' failed in phase `Literate pre-processor'</span><span class="ex">.</span> <span class="er">(</span><span class="ex">Exit</span> code: 1<span class="kw">)</span></span></code></pre></div>
<p>And it only says my first line of code is incorrect.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode sh"><code class="sourceCode bash"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">|</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="ex">1</span> <span class="kw">|</span>  <span class="ex">This</span> module applys css parallax on Yesod by creating Yesod widget</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">|</span> <span class="ex">^</span></span></code></pre></div>
<p>For the first time I met those error, I totally had no idea what to do next.</p>
<h1 id="todo">TODO</h1>
<p>add support individual parallax item</p>

    </div>

    <footer id="main-footer">
      Site proudly generated by
      <a href="http://jaspervdj.be/hakyll">Hakyll</a>
    </footer>
  </body>
</html>

<!--
    Todo:
    add basic parallax and add some gradation??
    
    -->
