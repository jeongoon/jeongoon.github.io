<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" class="font-sans">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

    <meta name="author" content="Myoungjin Jeon">


    <meta name="description" content="create some functions or abbr to utilize your daily shell (fish)">


    <meta name="keywords" content="fish, shell, script, function, util, DRY">

   <!-- even though I setup @media to make change all the fixed font size;
        FF on mobile -- incorrectly -- scales font size again.
        This happends when:

        1. default font size variable (ex: 2vw, 3.5vw)
        2. the width of some division is larger than original width of website
           should be (or designed to be)
        3. now we have larger webstie width and mobile webbrowser scale down the
           website
        4. now we have too small size font
        5. FF scales up the font, which is irrelevant to the other normal divs.

     so I ended up re-insert below meta line again to correct them.
    -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>MJ's kind weird Code - DRY(Do not Repeat Yourself) in fish</title>
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Atma:wght@300;500;700&family=Barlow+Condensed:ital,wght@0,100;0,300;0,600;1,100;1,500;1,600&family=Gamja+Flower&family=Hubballi&family=Jost:ital,wght@0,100;0,300;0,500;0,800;1,100;1,300;1,500;1,800&family=Unica+One&display=swap');
    </style> 
    <link rel="stylesheet" type="text/css" href="../css/19Apr2022.css" />
    <link rel="stylesheet" type="text/css" href="../css/12Apr2022.code.css" />
  </head>
  <body class="surface-color">
    <header id="main-header">
      <div id="logo" class="font-atma primary-color">
        <a href="../">MJ's Kind Weird Code</a>
      </div>
      <div id="page-title">
        <p> ðŸ“° DRY(Do not Repeat Yourself) in fish
        </p>
      </div>
      <nav id="main-nav" class="font-menu-title">
        <a href="../">Home</a>
        <a href="../about.html">About</a>
        <a href="../contact.html">Contact</a>
        <a href="../drafts.html">Drafts</a>
        <a href="../archive.html">Archive</a>
      </nav>
    </header>

    <div id="content" class="font-friendly">
            <div class="info">
    Posted on April 16, 2022
    
        by Myoungjin Jeon
    
</div>
<div class="info">
  
  Tags: <a title="All pages tagged 'fish'." href="../tags/fish.html">fish</a>, <a title="All pages tagged 'shell'." href="../tags/shell.html">shell</a>, <a title="All pages tagged 'script'." href="../tags/script.html">script</a>, <a title="All pages tagged 'function'." href="../tags/function.html">function</a>, <a title="All pages tagged 'util'." href="../tags/util.html">util</a>
  
</div>

<h2 id="we-need-functions">We Need Functions</h2>
<p>Moving files, compling source codes, checking out git repositories â€¦
To get jobs done, We are frequently use command line tool.</p>
<p>Even if just change your working diretory â€“ behind the scene â€“ your shell
is working for you to get informative prompt thesedays, isnâ€™t it?</p>
<p>To do some work easier or faster, we could recall by searching your shell
history or you could make a function to do the tasks.</p>
<h2 id="what-is-function-in-fish-shell">What is Function in Fish Shell</h2>
<h3 id="a-piece-of-codes">A piece of codes</h3>
<p>A function is a block of code that is reusable and performs certain operations.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>
And Iâ€™d like to remind you an UNIX principle, <em>KISS</em>!</p>
<blockquote>
<p><strong>KISS:</strong> Keep it simple and stupid</p>
</blockquote>
<p><em>We need to best of ourselves</em> but keep our programme simple and stupid at the same time,
to make a function:</p>
<ul>
<li>a maintainable size of <em>block</em></li>
<li>in a more readable form</li>
</ul>
<h3 id="a-part-of-your-session">A part of your session</h3>
<p>Function is so common in progamming langauges, however, I found that it has
some different aspects along with the similarity.</p>
<blockquote>
<p>Even though We could call them in a shell, A function is not an individual programme.</p>
</blockquote>
<ul>
<li><p>A function is a part of your shell <em>session</em>, if we are using <code class="verbatim">exit</code> in a function,
it will actually shut down your current session.</p></li>
<li><p>We cannot control it as a process as this is not a child process,
if we are using <code class="verbatim">sleep</code> in a function, it will actually sleep <em>your current session</em>.</p></li>
</ul>
<div class="sourceCode" id="cb1" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">fish</span><span class="op">&gt;</span> function sleep_10sec<span class="kw">;</span> <span class="fu">sleep</span> 10<span class="kw">;</span> <span class="ex">end</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="ex">fish</span><span class="op">&gt;</span> sleep_10sec <span class="kw">&amp;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="ex">...</span> paused ...</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="ex">^C</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="ex">fish:</span> Job 1, <span class="st">'echo_e &amp;'</span> has ended</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="ex">fish</span><span class="op">&gt;</span> # note I canceled by pressing Ctrl-C on x86_64 linux</span></code></pre></div>
<p>So if you want to function act as a programme, you need to put in a separate file.
and execute in another (child) fish shell. But how to make a shell script is beyond
this article, Iâ€™ll post about it maybe another article.</p>
<h3 id="function-as-aliasing">function as aliasing</h3>
<p>I use <em>emacs</em> daily, and sometimes I use emacs in terminal as well and below function
will make an alias for shorter name of the programme.</p>
<pre class="fish"><code># ~/.config/fish/functions/em.fish
function em --description 'alias em emacs -nw $argv'
    emacs -nw $argv
end

function mc --description 'alias mc emacsclient $argv'
    emacsclient -tc $argv
end
</code></pre>
<p>Another famous example of aliasing might be:</p>
<div class="sourceCode" id="cb3" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span><span class="fu"> rm</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rm</span> <span class="at">-i</span> <span class="va">$argv</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="ex">end</span></span></code></pre></div>
<p>and fish shell provide wrapper function <a href="https://fishshell.com/docs/current/cmds/alias.html?highlight=alias"><code class="verbatim">alias</code></a> as well.</p>
<div class="sourceCode" id="cb4" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="bu">alias</span> rmi=<span class="st">&quot;rm -i&quot;</span></span></code></pre></div>
<p>This is actually care about more like below:</p>
<pre class="fish"><code>alias rmi=&quot;rm -i&quot;

# This is equivalent to entering the following function:
function rmi --wraps rm --description 'alias rmi=rm -i'
    rm -i $argv
end
</code></pre>
<p><em>â€“wraps rm</em> provides autocompletion which is same as <em>rm</em>. and makes a description on
behalf of you.</p>
<h3 id="how-about-abbr">how about abbr?</h3>
<p>works differently, but also helpful as <em>abbr</em> replace your typing words and you
can still edit your typing as well. Please read about <a href="https://fishshell.com/docs/current/cmds/abbr.html?highlight=abbr">this</a> for more information.</p>
<h2 id="function-requirement">Function requirement</h2>
<h3 id="variable">Variable</h3>
<p>To use variables in function is common, even though we donâ€™t need at all sometimes.
a variable could be set by <a href="https://fishshell.com/docs/current/cmds/set.html?highlight=set"><code class="verbatim">set</code></a>. One big diffent thing from bash is that
<code class="verbatim">set</code> doesnâ€™t require any <code class="verbatim">=</code> sign. So you could possibly make some typo</p>
<div class="sourceCode" id="cb6" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">fish</span><span class="op">&gt;</span> set <span class="at">-l</span> local_var = <span class="st">&quot;my_example_value&quot;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="ex">fish</span><span class="op">&gt;</span> set <span class="at">-S</span> local_var</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="va">$local_var</span><span class="ex">:</span> set in local scope, unexported, with 2 elements</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="va">$local_var</span><span class="ex">[1]:</span> <span class="kw">|</span><span class="ex">=</span><span class="kw">|</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="va">$local_var</span><span class="ex">[2]:</span> <span class="kw">|</span><span class="ex">my_example_value</span><span class="kw">|</span></span></code></pre></div>
<p>so <code class="verbatim">local_var</code> above becomes an array. Which makes me hard to debug sometimes. because
<em>fish</em> will trust you. As there was no syntax error.</p>
<h3 id="return-value">Return value</h3>
<p>A function is not a programme, but at the same time return value is quite similar to
a programme as return value will always be an unsigned char(integer) value.</p>
<div class="sourceCode" id="cb7" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">fish</span><span class="op">&gt;</span> function test_return<span class="kw">;</span> <span class="cf">return</span> <span class="ex">-1</span><span class="kw">;</span> <span class="ex">end</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="ex">fish</span><span class="op">&gt;</span> test_return</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="ex">fish</span><span class="op">&gt;</span> echo <span class="va">$status</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="ex">255</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="ex">fish</span><span class="op">&gt;</span> functions <span class="at">-e</span> test_return</span></code></pre></div>
<p>There are some way to save its return value, however using echo and using command subsitution
is a common way because it is common for unix tiny programmes, to communicate each other
via <em>pipe</em>, <em>fifo</em>.</p>
<div class="sourceCode" id="cb8" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">fish</span><span class="op">&gt;</span> set today <span class="er">(</span><span class="fu">date</span> <span class="st">&quot;+%Y-%m-%d&quot;</span><span class="kw">)</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="ex">fish</span><span class="op">&gt;</span> echo <span class="va">$today</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="ex">2022-04-20</span></span></code></pre></div>
<h3 id="arguments">Arguments</h3>
<p>As you can see in <em>rmi</em> alias in the prior example, <em>$argv</em> is a special variable which
takes all the arguments you passed.</p>
<h3 id="input-output">Input / Output</h3>
<p>This a way to communicate each other. Your <em>shell from/to function</em> or <em>function to function</em>,
we will use shell subsitution like the prior example or pipe <code class="verbatim">|</code>.</p>
<div class="sourceCode" id="cb9" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">fish</span><span class="op">&gt;</span>  echo <span class="st">&quot;test.org&quot;</span> <span class="kw">|</span> <span class="fu">sed</span> <span class="st">'s/\.org$/\.md/'</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="ex">test.md</span></span></code></pre></div>
<h2 id="function-named-function">Function named â€˜functionâ€™</h2>
<h3 id="function-command">function command</h3>
<ol>
<li><p>-d option</p></li>
<li><p>-S / -V</p>
<ul>
<li>Recap fish variable Pros and Cons</li>
</ul></li>
</ol>
<h2 id="section-1"></h2>
<p>functions directory for permanent access</p>
<p>still need to source</p>
<h3 id="function">function</h3>
<h2 id="example-function">Example Function</h2>
<h3 id="elem-function">elem function</h3>
<ol>
<li><p>what is elem</p></li>
<li><p>where can I use?</p></li>
</ol>
<h1 id="footnotes">Footnotes</h1>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>Introduction to Function in Shell Scripting: <a href="https://www.educba.com/function-in-shell-scripting/">https://www.educba.com/function-in-shell-scripting/</a><a href="#fnref1" class="footnote-back" role="doc-backlink">â†©ï¸Ž</a></p></li>
</ol>
</section>

    </div>

    <footer id="main-footer">
      Site proudly generated by
      <a href="http://jaspervdj.be/hakyll">Hakyll</a>
    </footer>
  </body>
</html>

<!--
    Todo:
    add basic parallax and add some gradation??
    
    -->
